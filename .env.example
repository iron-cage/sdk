# Iron API Server Environment Configuration
#
# Copy this file to .env and fill in your values
#
# For pilot/development mode, default values work out of the box.
# For production, ALL values marked REQUIRED must be set.

# =============================================================================
# DATABASE
# =============================================================================

# SQLite connection string for pilot mode
# The ?mode=rwc parameter is REQUIRED for SQLite to create the database file
# Default: sqlite://./iron.db?mode=rwc
DATABASE_URL=sqlite://./iron.db?mode=rwc

# =============================================================================
# AUTHENTICATION
# =============================================================================

# JWT secret key for signing access and refresh tokens
# SECURITY: Change this in production! Generate with: openssl rand -base64 32
# Default (dev only): dev-secret-change-in-production
JWT_SECRET=dev-secret-change-in-production

# =============================================================================
# AI PROVIDER KEY ENCRYPTION
# =============================================================================

# Master key for AES-256-GCM encryption of AI provider API keys
# REQUIRED for provider key management feature
# Generate with: openssl rand -base64 32
#
# SECURITY WARNING:
# - Loss of this key = permanent loss of all encrypted API keys
# - Never commit to git
# - Backup in separate secure location
# - For production: use AWS KMS or similar
IRON_SECRETS_MASTER_KEY=

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================

# Explicit deployment mode (optional)
# Set to "production" to confirm production deployment
# If not set, server will detect environment heuristically and warn if production detected
# Values: production, pilot (or leave unset for auto-detection)
# IRON_DEPLOYMENT_MODE=pilot

# =============================================================================
# DOCKER COMPOSE DEPLOYMENT (PostgreSQL)
# =============================================================================

# PostgreSQL database password
# REQUIRED for docker-compose.yml
# Generate with: openssl rand -hex 32
POSTGRES_PASSWORD=

# =============================================================================
# QUICK START (Development)
# =============================================================================
#
# Option 1: Native Development (SQLite)
# 1. Copy this file to .env
# 2. Generate master key: openssl rand -base64 32
# 3. Set IRON_SECRETS_MASTER_KEY to the generated value
# 4. Start server: cargo run --bin iron_control_api_server
#
# Option 2: Docker Compose (PostgreSQL)
# 1. Copy this file to .env
# 2. Generate secrets:
#    openssl rand -hex 32    # For POSTGRES_PASSWORD
#    openssl rand -hex 32    # For JWT_SECRET
#    openssl rand -base64 32 # For IRON_SECRETS_MASTER_KEY
# 3. Set all three secrets in .env
# 4. Update DATABASE_URL to use PostgreSQL:
#    DATABASE_URL=postgresql://iron_user:${POSTGRES_PASSWORD}@localhost:5432/iron_tokens
# 5. Start services: docker compose up -d
#
# Example secret generation:
#   $ openssl rand -base64 32
#   K7x9F2mN4pQ8sT1vY3wZ6aB5cD0eF9gH2iJ4kL7mN8o=
